/// <reference path="../../../typings/tsd.d.ts" />
/// <reference path="../connection/connection.service.ts" />
var Q = require("q");
var connection = require('../connection/connection.service');
var ProductsService = (function () {
    function ProductsService() {
        this.db = connection.service;
    }
    ProductsService.prototype.getProductsNew = function (page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_recent_posts&count=4&page=' + page).then(function (results) {
            _listPromise.resolve(results);
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductsList = function (page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_posts&count=4&page=' + page).then(function (results) {
            _listPromise.resolve(results);
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductById = function (productId) {
        return this.db.query('core/get_post/?id=' + productId);
    };
    ProductsService.prototype.getProductsByAuthor = function (authorId, page) {
        return this.db.query('core/get_author_posts/?count=4&id=' + authorId + '&page=' + page);
    };
    ProductsService.prototype.getProductsByCategory = function (categoryId, page) {
        return this.db.query('core/get_category_posts/?count=4&id=' + categoryId + '&page=' + page);
    };
    ProductsService.prototype.getProductsByTag = function (tagId, page) {
        return this.db.query('core/get_tag_posts/?count=4&id=' + tagId + '&page=' + page);
    };
    ProductsService.prototype.createProduct = function (nonce, author, title, content, status, categories, tags) {
        return this.db.query('posts/create_post/?nonce=' + nonce + '&author=' + author + '&title=' + title + '&content=' + content + '&status=' + status + '&categories=' + categories + '&tags=' + tags);
    };
    ProductsService.prototype.updateProduct = function (nonce, productId, author, title, content, status, categories, tags) {
        return this.db.query('posts/update_post/?nonce=' + nonce + '&id=' + productId + '&author=' + author + '&title=' + title + '&content=' + content + '&status=' + status + '&categories=' + categories + '&tags=' + tags);
    };
    ProductsService.prototype.deleteProduct = function (nonce, productId) {
        return this.db.query('posts/delete_post/?nonce=' + nonce + '&id=' + productId);
    };
    ProductsService.prototype.createComment = function (productId, cookie, content) {
        return this.db.query('user/post_comment/?post_id=' + productId + '&cookie=' + cookie + '&comment_status=1' + '&content=' + content);
    };
    return ProductsService;
})();
exports.ProductsService = ProductsService;
;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZXMvcHJvZHVjdHMvcHJvZHVjdHMuc2VydmljZS50cyJdLCJuYW1lcyI6WyJQcm9kdWN0c1NlcnZpY2UiLCJQcm9kdWN0c1NlcnZpY2UuY29uc3RydWN0b3IiLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNOZXciLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNMaXN0IiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RCeUlkIiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzQnlBdXRob3IiLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNCeUNhdGVnb3J5IiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzQnlUYWciLCJQcm9kdWN0c1NlcnZpY2UuY3JlYXRlUHJvZHVjdCIsIlByb2R1Y3RzU2VydmljZS51cGRhdGVQcm9kdWN0IiwiUHJvZHVjdHNTZXJ2aWNlLmRlbGV0ZVByb2R1Y3QiLCJQcm9kdWN0c1NlcnZpY2UuY3JlYXRlQ29tbWVudCJdLCJtYXBwaW5ncyI6IkFBQUEsa0RBQWtEO0FBQ2xELDREQUE0RDtBQUU1RCxJQUFPLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQztBQUN4QixJQUFPLFVBQVUsV0FBVyxrQ0FBa0MsQ0FBQyxDQUFBO0FBb0IvRCxJQUFhLGVBQWU7SUFBNUJBLFNBQWFBLGVBQWVBO1FBQ2hCQyxPQUFFQSxHQUFHQSxVQUFVQSxDQUFDQSxPQUFPQSxDQUFDQTtJQTBFcENBLENBQUNBO0lBeEVHRCx3Q0FBY0EsR0FBZEEsVUFBZUEsSUFBSUE7UUFDZkUsSUFBSUEsWUFBWUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsRUFBRUEsQ0FBQ0E7UUFDN0JBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLEtBQUtBLENBQUNBLDJDQUEyQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsQ0FDNURBLElBQUlBLENBQUNBLFVBQUNBLE9BQU9BO1lBQ1ZBLFlBQVlBLENBQUNBLE9BQU9BLENBQUNBLE9BQU9BLENBQUNBLENBQUNB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QSxVQUFjQSxLQUFLQSxFQUFFQSxTQUFTQTtRQUMxQlUsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsMkJBQTJCQSxHQUFHQSxLQUFLQSxHQUNuQ0EsTUFBTUEsR0FBR0EsU0FBU0EsQ0FBQ0EsQ0FBQUE7SUFDNUNBLENBQUNBO0lBRURWLHVDQUFhQSxHQUFiQSxVQUFjQSxTQUFTQSxFQUFFQSxNQUFNQSxFQUFFQSxPQUFPQTtRQUNwQ1csTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsNkJBQTZCQSxHQUFHQSxTQUFTQSxHQUN6Q0EsVUFBVUEsR0FBR0EsTUFBTUEsR0FDbkJBLG1CQUFtQkEsR0FDbkJBLFdBQVdBLEdBQUdBLE9BQU9BLENBQUNBLENBQUFBO0lBQy9DQSxDQUFDQTtJQUVMWCxzQkFBQ0E7QUFBREEsQ0EzRUEsQUEyRUNBLElBQUE7QUEzRVksdUJBQWUsR0FBZixlQTJFWixDQUFBO0FBQUEsQ0FBQyIsImZpbGUiOiJtb2R1bGVzL3Byb2R1Y3RzL3Byb2R1Y3RzLnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLi4vdHlwaW5ncy90c2QuZC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vY29ubmVjdGlvbi9jb25uZWN0aW9uLnNlcnZpY2UudHNcIiAvPlxuXG5pbXBvcnQgUSA9IHJlcXVpcmUoXCJxXCIpO1xuaW1wb3J0IGNvbm5lY3Rpb24gPSByZXF1aXJlKCcuLi9jb25uZWN0aW9uL2Nvbm5lY3Rpb24uc2VydmljZScpXG5cbmV4cG9ydCBpbnRlcmZhY2UgSVByb2R1Y3RzU2VydmljZSB7XG4gICAgLy8gR0VUXG4gICAgZ2V0UHJvZHVjdHNOZXcocGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldFByb2R1Y3RzTGlzdChwYWdlKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdEJ5SWQocHJvZHVjdElkKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNCeUF1dGhvcihhdXRob3JJZCwgcGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldFByb2R1Y3RzQnlDYXRlZ29yeShjYXRlZ29yeUlkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNCeVRhZyh0YWdJZCwgcGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIC8vIFBPU1RcbiAgICBjcmVhdGVQcm9kdWN0KG5vbmNlLCBhdXRob3IsIHRpdGxlLCBjb250ZW50LCBzdGF0dXMsIGNhdGVnb3JpZXMsIHRhZ3MpOiBRLklQcm9taXNlPHt9PjtcbiAgICBjcmVhdGVDb21tZW50KHByb2R1Y3RJZCwgY29va2llLCBjb250ZW50KTogUS5JUHJvbWlzZTx7fT47XG4gICAgLy8gUFVUXG4gICAgdXBkYXRlUHJvZHVjdChub25jZSwgcHJvZHVjdElkLCBhdXRob3IsIHRpdGxlLCBjb250ZW50LCBzdGF0dXMsIGNhdGVnb3JpZXMsIHRhZ3MpOiBRLklQcm9taXNlPHt9PjtcbiAgICAvLyBERUxFVEVcbiAgICBkZWxldGVQcm9kdWN0KG5vbmNlLCBwcm9kdWN0SWQpOiBRLklQcm9taXNlPHt9Pjtcbn1cblxuXG5leHBvcnQgY2xhc3MgUHJvZHVjdHNTZXJ2aWNlIGltcGxlbWVudHMgSVByb2R1Y3RzU2VydmljZSB7XG4gICAgcHJpdmF0ZSBkYiA9IGNvbm5lY3Rpb24uc2VydmljZTtcblxuICAgIGdldFByb2R1Y3RzTmV3KHBhZ2UpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHZhciBfbGlzdFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHRoaXMuZGIucXVlcnkoJ2NvcmUvP2pzb249Z2V0X3JlY2VudF9wb3N0cyZjb3VudD00JnBhZ2U9JyArIHBhZ2UpXG4gICAgICAgICAgICAudGhlbigocmVzdWx0cykgPT4ge1xuICAgICAgICAgICAgICAgIF9saXN0UHJvbWlzZS5yZXNvbHZlKHJlc3VsdHMpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gX2xpc3RQcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG4gICAgZ2V0UHJvZHVjdHNMaXN0KHBhZ2UpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHZhciBfbGlzdFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHRoaXMuZGIucXVlcnkoJ2NvcmUvP2pzb249Z2V0X3Bvc3RzJmNvdW50PTQmcGFnZT0nICsgcGFnZSlcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgX2xpc3RQcm9taXNlLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIHJldHVybiBfbGlzdFByb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0QnlJZChwcm9kdWN0SWQpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLnF1ZXJ5KCdjb3JlL2dldF9wb3N0Lz9pZD0nICsgcHJvZHVjdElkKVxuICAgIH1cblxuICAgIGdldFByb2R1Y3RzQnlBdXRob3IoYXV0aG9ySWQsIHBhZ2UpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLnF1ZXJ5KCdjb3JlL2dldF9hdXRob3JfcG9zdHMvP2NvdW50PTQmaWQ9JyArIGF1dGhvcklkICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZwYWdlPScgKyBwYWdlKVxuICAgIH1cblxuICAgIGdldFByb2R1Y3RzQnlDYXRlZ29yeShjYXRlZ29yeUlkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5xdWVyeSgnY29yZS9nZXRfY2F0ZWdvcnlfcG9zdHMvP2NvdW50PTQmaWQ9JyArIGNhdGVnb3J5SWQgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnBhZ2U9JyArIHBhZ2UpXG4gICAgfVxuXG4gICAgZ2V0UHJvZHVjdHNCeVRhZyh0YWdJZCwgcGFnZSk6IFEuSVByb21pc2U8e30+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIucXVlcnkoJ2NvcmUvZ2V0X3RhZ19wb3N0cy8/Y291bnQ9NCZpZD0nICsgdGFnSWQgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnBhZ2U9JyArIHBhZ2UpXG4gICAgfVxuXG4gICAgY3JlYXRlUHJvZHVjdChub25jZSwgYXV0aG9yLCB0aXRsZSwgY29udGVudCwgc3RhdHVzLCBjYXRlZ29yaWVzLCB0YWdzKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5xdWVyeSgncG9zdHMvY3JlYXRlX3Bvc3QvP25vbmNlPScgKyBub25jZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmYXV0aG9yPScgKyBhdXRob3IgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnRpdGxlPScgKyB0aXRsZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmY29udGVudD0nICsgY29udGVudCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmc3RhdHVzPScgKyBzdGF0dXMgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJmNhdGVnb3JpZXM9JyArIGNhdGVnb3JpZXMgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnRhZ3M9JyArIHRhZ3MpXG4gICAgfVxuXG4gICAgdXBkYXRlUHJvZHVjdChub25jZSwgcHJvZHVjdElkLCBhdXRob3IsIHRpdGxlLCBjb250ZW50LCBzdGF0dXMsIGNhdGVnb3JpZXMsIHRhZ3MpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLnF1ZXJ5KCdwb3N0cy91cGRhdGVfcG9zdC8/bm9uY2U9JyArIG5vbmNlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZpZD0nICsgcHJvZHVjdElkICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZhdXRob3I9JyArIGF1dGhvciArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmdGl0bGU9JyArIHRpdGxlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZjb250ZW50PScgKyBjb250ZW50ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZzdGF0dXM9JyArIHN0YXR1cyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmY2F0ZWdvcmllcz0nICsgY2F0ZWdvcmllcyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmdGFncz0nICsgdGFncylcbiAgICB9XG5cbiAgICBkZWxldGVQcm9kdWN0KG5vbmNlLCBwcm9kdWN0SWQpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLnF1ZXJ5KCdwb3N0cy9kZWxldGVfcG9zdC8/bm9uY2U9JyArIG5vbmNlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZpZD0nICsgcHJvZHVjdElkKVxuICAgIH1cblxuICAgIGNyZWF0ZUNvbW1lbnQocHJvZHVjdElkLCBjb29raWUsIGNvbnRlbnQpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLnF1ZXJ5KCd1c2VyL3Bvc3RfY29tbWVudC8/cG9zdF9pZD0nICsgcHJvZHVjdElkICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZjb29raWU9JyArIGNvb2tpZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmY29tbWVudF9zdGF0dXM9MScgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJmNvbnRlbnQ9JyArIGNvbnRlbnQpXG4gICAgfVxuXG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9