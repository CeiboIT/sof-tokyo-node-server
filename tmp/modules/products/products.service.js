/// <reference path="../../../typings/tsd.d.ts" />
/// <reference path="../connection/connection.service.ts" />
var Q = require("q");
var connection = require('../connection/connection.service');
var auth = require("../auth/auth.service");
var metadata = require("../metadata/metadata.service");
var authServ = new auth.AuthService();
var metadataServ = new metadata.MetadataService();
var inArray = function (myArray, myValue) {
    var inArray = false;
    myArray.map(function (key) {
        if (key === myValue) {
            inArray = true;
        }
    });
    return inArray;
};
var ProductsService = (function () {
    function ProductsService() {
        this.db = connection.service;
    }
    ProductsService.prototype.getProductsNew = function (page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_recent_posts&count=4&page=' + page).then(function (results) {
            var _postAuthorPopulate = [];
            var _postMetadataPopulate = [];
            results['posts'].forEach(function (result) {
                var authorPromise = Q.defer();
                var metadataPromise = Q.defer();
                _postAuthorPopulate.push(authorPromise.promise);
                _postMetadataPopulate.push(metadataPromise.promise);
                // populate author's avatar
                authServ.getUserAvatar(result.author.id, "thumb").then(function (data) {
                    result['author']['avatar'] = data['avatar'];
                    authorPromise.resolve(data);
                    // populate metadata
                    metadataServ.getProductMetadata(result.id).then(function (data2) {
                        result['metadata'] = data2;
                        metadataPromise.resolve(data2);
                    });
                });
            });
            Q.all(_postAuthorPopulate.concat(_postMetadataPopulate)).then(function (values) {
                _listPromise.resolve(results);
            });
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductsList = function (page) {
        var _listPromise = Q.defer();
        var count = 6;
        this.db.query('core/?json=get_posts&count=' + count + '&page=' + page).then(function (results) {
            function shuffle(o) {
                for (var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x)
                    ;
                return o;
            }
            var shuffled = shuffle(results['posts']);
            results['posts'] = shuffled;
            var _postAuthorPopulate = [];
            var _postMetadataPopulate = [];
            results['posts'].forEach(function (result) {
                var authorPromise = Q.defer();
                var metadataPromise = Q.defer();
                _postAuthorPopulate.push(authorPromise.promise);
                _postMetadataPopulate.push(metadataPromise.promise);
                // populate author's avatar
                authServ.getUserAvatar(result.author.id, "thumb").then(function (data) {
                    result['author']['avatar'] = data['avatar'];
                    authorPromise.resolve(data);
                    // populate metadatagi
                    metadataServ.getProductMetadata(result.id).then(function (data2) {
                        result['metadata'] = data2;
                        metadataPromise.resolve(data2);
                    });
                });
            });
            Q.all(_postAuthorPopulate.concat(_postMetadataPopulate)).then(function (values) {
                _listPromise.resolve(results);
            });
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductById = function (productId) {
        var _this = this;
        var _productPromise = Q.defer();
        this.db.query('core/get_post/?id=' + productId).then(function (result) {
            var _promises = [];
            // save visit
            var saveVisitPromise = Q.defer();
            _promises.push(saveVisitPromise.promise);
            var visitQuery = "INSERT INTO wp2_post_views (id, type, period, count) " + "VALUES (" + productId + ",4,'total',1) " + "ON DUPLICATE KEY UPDATE count=count+1";
            _this.db.query_db(visitQuery).then(function () {
                saveVisitPromise.resolve(undefined);
            });
            // populate product visits
            var viewVisitsPromise = Q.defer();
            _promises.push(viewVisitsPromise.promise);
            var visitQuery = "SELECT count FROM wp2_post_views " + "WHERE id=" + productId + " AND type=4 AND period='total'";
            _this.db.query_db(visitQuery).then(function (data) {
                result['post']['visits'] = data[0]['count'];
                viewVisitsPromise.resolve(undefined);
            });
            // populate author's avatar
            authServ.getUserAvatar(result['post']['author']['id'], "thumb").then(function (data) {
                var authorPromise = Q.defer();
                _promises.push(authorPromise.promise);
                result['post']['author']['avatar'] = data['avatar'];
                authorPromise.resolve(data);
            });
            if (result['post']['comments'] && result['post']['comments'].length) {
                // for each comment
                result['post']['comments'].forEach(function (comment) {
                    var commentPromise = Q.defer();
                    _promises.push(commentPromise.promise);
                    // populate comments avatar
                    authServ.getUserAvatar(comment.author.id, "thumb").then(function (avatar) {
                        comment['author']['avatar'] = avatar['avatar'];
                        commentPromise.resolve(avatar);
                    });
                });
            }
            // populate metadata
            metadataServ.getProductMetadata(result['post']['id']).then(function (metadata) {
                var metadataPromise = Q.defer();
                _promises.push(metadataPromise.promise);
                result['post']['metadata'] = metadata;
                metadataPromise.resolve(metadata);
            });
            Q.all(_promises).then(function (values) {
                _productPromise.resolve(result);
            });
        });
        return _productPromise.promise;
    };
    ProductsService.prototype.getProductsByAuthor = function (authorId) {
        var _promise = Q.defer();
        this.db.query('core/get_author_posts/?count=4&id=' + authorId).then(function (results) {
            var _postAuthorPopulate = [];
            var _postMetadataPopulate = [];
            var headerPromise = Q.defer();
            _postAuthorPopulate.push(headerPromise.promise);
            // populate header avatar
            authServ.getUserAvatar(results['author']['id'], "thumb").then(function (data) {
                results['author']['avatar'] = data['avatar'];
                headerPromise.resolve(data);
                results['posts'].forEach(function (result) {
                    var authorPromise = Q.defer();
                    var metadataPromise = Q.defer();
                    _postAuthorPopulate.push(authorPromise.promise);
                    _postMetadataPopulate.push(metadataPromise.promise);
                    // populate author's avatar
                    result['author']['avatar'] = data['avatar'];
                    authorPromise.resolve(data);
                    // populate metadata
                    metadataServ.getProductMetadata(result.id).then(function (data2) {
                        result['metadata'] = data2;
                        metadataPromise.resolve(data2);
                    });
                });
                Q.all(_postAuthorPopulate.concat(_postMetadataPopulate)).then(function (values) {
                    _promise.resolve(results);
                });
            });
        });
        return _promise.promise;
    };
    ProductsService.prototype.getProductsBySchool = function (schoolId, page) {
        var _this = this;
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_posts&count=200').then(function (results) {
            var posts = results['posts'];
            _this.db.query_db("SELECT user_id FROM wp2_bp_xprofile_data WHERE value='" + schoolId + "' AND field_id=4").then(function (data) {
                var userIds = [];
                for (var i in data) {
                    userIds.push(data[i].user_id);
                }
                var schoolPosts = [];
                for (var j in posts) {
                    if (inArray(userIds, posts[j].author.id)) {
                        schoolPosts.push(posts[j]);
                    }
                    ;
                }
                ;
                results['posts'] = schoolPosts;
                results['school'] = schoolId;
                results['count'] = schoolPosts.length;
                results['count_total'] = schoolPosts.length;
                _listPromise.resolve(results);
            });
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductsByOptionsSearch = function (search, subcategory0, subcategory1, style, sex) {
        var _promise = Q.defer();
        if (search == 'null')
            search = '';
        if (subcategory0 == 'null')
            search = '';
        if (subcategory1 == 'null')
            search = '';
        if (style == 'null')
            search = '';
        if (sex == 'null')
            search = '';
        var query = "SELECT post_data.post_id, post_data.title, post_data.date, post_data.author, " + "image.image, subcategory0.subcategory0, subcategory1.subcategory1, style.style, sex.sex " + "FROM " + "(SELECT wp2_posts.ID AS post_id, " + "wp2_posts.post_title AS title, " + "wp2_posts.post_date_gmt AS date, " + "wp2_users.display_name AS author, " + "wp2_users.ID AS author_id " + "FROM `wp2_posts` " + "JOIN wp2_users " + "ON wp2_posts.post_author = wp2_users.ID " + "WHERE wp2_posts.post_title LIKE '%" + search + "%' " + ") post_data " + "JOIN " + "(SELECT wp2_postmeta.post_id, " + "wp2_postmeta.meta_value AS image " + "FROM wp2_postmeta " + "WHERE wp2_postmeta.meta_key = 'sofbackend__sof_work_meta__postImage' " + ") image " + "ON post_data.post_id = image.post_id " + "JOIN " + "(SELECT wp2_postmeta.post_id, " + "wp2_postmeta.meta_value AS subcategory0 " + "FROM wp2_postmeta " + "WHERE wp2_postmeta.meta_key = 'sofbackend__sof_work_meta__category_0' " + "AND wp2_postmeta.meta_value LIKE '%" + subcategory0 + "%' " + ") subcategory0 " + "ON post_data.post_id = subcategory0.post_id " + "JOIN " + "(SELECT wp2_postmeta.post_id, " + "wp2_postmeta.meta_value AS subcategory1 " + "FROM wp2_postmeta " + "WHERE wp2_postmeta.meta_key = 'sofbackend__sof_work_meta__category_1' " + "AND wp2_postmeta.meta_value LIKE '%" + subcategory1 + "%' " + ") subcategory1 " + "ON post_data.post_id = subcategory1.post_id " + "JOIN " + "(SELECT wp2_postmeta.post_id, " + "wp2_postmeta.meta_value AS style " + "FROM wp2_postmeta " + "WHERE wp2_postmeta.meta_key = 'sofbackend__sof_work_meta__style' " + "AND wp2_postmeta.meta_value LIKE '%" + style + "%' " + ") style " + "ON post_data.post_id = style.post_id " + "JOIN " + "(SELECT wp2_postmeta.post_id, " + "wp2_postmeta.meta_value AS sex " + "FROM wp2_postmeta " + "WHERE wp2_postmeta.meta_key = 'sofbackend__sof_work_meta__sex' " + "AND wp2_postmeta.meta_value LIKE '%" + sex + "%' " + ") sex " + "ON post_data.post_id = sex.post_id " + "ORDER BY post_id " + "LIMIT 10";
        this.db.query_db(query).then(function (data) {
            var dataJson = JSON.parse(JSON.stringify(data));
            var _postAuthorPopulate = [];
            var _postMetadataPopulate = [];
            dataJson.forEach(function (result) {
                var authorPromise = Q.defer();
                var metadataPromise = Q.defer();
                _postAuthorPopulate.push(authorPromise.promise);
                _postMetadataPopulate.push(metadataPromise.promise);
                // populate author's avatar
                authServ.getUserAvatar(result['author_id'], "thumb").then(function (data) {
                    result['author_avatar'] = data['avatar'];
                    authorPromise.resolve(data);
                    // populate metadata
                    metadataServ.getProductMetadata(result.post_id).then(function (data2) {
                        result['metadata'] = data2;
                        metadataPromise.resolve(data2);
                    });
                });
            });
            Q.all(_postAuthorPopulate.concat(_postMetadataPopulate)).then(function (values) {
                _promise.resolve(dataJson);
            });
        });
        return _promise.promise;
    };
    ProductsService.prototype.getProductsBySubcategory0 = function (subcategory0Id, page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_posts&count=200').then(function (results) {
            var posts = results['posts'];
            var subcategory0Posts = [];
            for (var i in posts) {
                if (posts[i]['custom_fields']['sofbackend__sof_work_meta__category_0'] == subcategory0Id) {
                    subcategory0Posts.push(posts[i]);
                }
                ;
            }
            ;
            results['posts'] = subcategory0Posts;
            results['subcategory0'] = subcategory0Id;
            results['count'] = subcategory0Posts.length;
            results['count_total'] = subcategory0Posts.length;
            _listPromise.resolve(results);
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductsBySubcategory1 = function (subcategory1Id, page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_posts&count=200').then(function (results) {
            var posts = results['posts'];
            var subcategory1Posts = [];
            for (var i in posts) {
                if (posts[i]['custom_fields']['sofbackend__sof_work_meta__category_1'] == subcategory1Id) {
                    subcategory1Posts.push(posts[i]);
                }
                ;
            }
            ;
            results['posts'] = subcategory1Posts;
            results['subcategory1'] = subcategory1Id;
            results['count'] = subcategory1Posts.length;
            results['count_total'] = subcategory1Posts.length;
            _listPromise.resolve(results);
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductsByStyle = function (styleId, page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_posts&count=200').then(function (results) {
            var posts = results['posts'];
            var stylePosts = [];
            for (var i in posts) {
                if (posts[i]['custom_fields']['sofbackend__sof_work_meta__style'] == styleId) {
                    stylePosts.push(posts[i]);
                }
                ;
            }
            ;
            results['posts'] = stylePosts;
            results['style'] = styleId;
            results['count'] = stylePosts.length;
            results['count_total'] = stylePosts.length;
            _listPromise.resolve(results);
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.getProductsBySex = function (sexId, page) {
        var _listPromise = Q.defer();
        this.db.query('core/?json=get_posts&count=200').then(function (results) {
            var posts = results['posts'];
            var sexPosts = [];
            for (var i in posts) {
                if (posts[i]['custom_fields']['sofbackend__sof_work_meta__sex'] == sexId) {
                    sexPosts.push(posts[i]);
                }
                ;
            }
            ;
            results['posts'] = sexPosts;
            results['sex'] = sexId;
            results['count'] = sexPosts.length;
            results['count_total'] = sexPosts.length;
            _listPromise.resolve(results);
        });
        return _listPromise.promise;
    };
    ProductsService.prototype.createProduct = function (nonce, author, title, content, status, school, subcategory0, subcategory1, styles) {
        return this.db.query('posts/create_post/?nonce=' + nonce + '&author=' + author + '&title=' + title + '&content=' + content + '&status=' + status).then(function (post) {
            console.log(post);
            // FALTA GUARDAR SCHOOL, SUBCATEGORY, STYLES
            return post;
        });
    };
    ProductsService.prototype.updateProduct = function (nonce, productId, author, title, content, status, categories, tags) {
        return this.db.query('posts/update_post/?nonce=' + nonce + '&id=' + productId + '&author=' + author + '&title=' + title + '&content=' + content + '&status=' + status + '&categories=' + categories + '&tags=' + tags);
    };
    ProductsService.prototype.deleteProduct = function (nonce, productId) {
        return this.db.query('posts/delete_post/?nonce=' + nonce + '&id=' + productId);
    };
    ProductsService.prototype.createComment = function (productId, cookie, content) {
        return this.db.query('user/post_comment/?post_id=' + productId + '&cookie=' + cookie + '&comment_status=1' + '&content=' + content);
    };
    ProductsService.prototype.getProductsBySearch = function (search, page) {
        var _searchPromise = Q.defer();
        this.db.query('core/get_search_results/?count=4&search=' + search + '&page=' + page).then(function (results) {
            var _postAuthorPopulate = [];
            results['posts'].forEach(function (result) {
                var authorPromise = Q.defer();
                _postAuthorPopulate.push(authorPromise.promise);
                authServ.getUserAvatar(result.author.id, "thumb").then(function (data) {
                    result['author']['avatar'] = data['avatar'];
                    authorPromise.resolve(data);
                    metadataServ.getProductMetadata(result.id).then(function (data2) {
                        result['metadata'] = data2;
                    });
                });
            });
            Q.all(_postAuthorPopulate).then(function () {
                _searchPromise.resolve(results);
            });
        });
        return _searchPromise.promise;
    };
    ProductsService.prototype.getProductsRankingByLikes = function () {
        var _this = this;
        var _responsePromise = Q.defer();
        var _productsPromises = [];
        var _response = {
            posts: []
        };
        var query = "SELECT * FROM " + "( " + "SELECT wp2_posts.ID AS post_id, " + "wp2_posts.post_title AS title, " + "wp2_posts.post_date_gmt AS date, " + "wp2_postmeta.meta_value AS likes, " + "wp2_users.display_name AS author " + "FROM `wp2_posts` " + "JOIN wp2_users ON wp2_posts.post_author = wp2_users.ID " + "JOIN wp2_postmeta ON wp2_posts.ID = wp2_postmeta.post_id " + "WHERE wp2_postmeta.meta_key = '_item_likes' " + ") table1 " + "ORDER BY likes DESC " + "LIMIT 5";
        this.db.query_db(query).then(function (data) {
            data.forEach(function (product) {
                var _promise = Q.defer();
                _productsPromises.push(_promise.promise);
                _this.getProductById(product['post_id']).then(function (result) {
                    _promise.resolve(result['post']);
                });
            });
            Q.all(_productsPromises).then(function (results) {
                _responsePromise.resolve(results);
            });
        });
        return _responsePromise.promise;
    };
    ProductsService.prototype.getProductsRankingByVisits = function () {
        var _promise = Q.defer();
        var query = "SELECT * FROM " + "( " + "SELECT wp2_posts.ID AS post_id, " + "wp2_posts.post_title AS title, " + "wp2_posts.post_date_gmt AS date, " + "wp2_users.display_name AS author, " + "wp2_post_views.count AS visits " + "FROM `wp2_posts` " + "JOIN wp2_users ON wp2_posts.post_author = wp2_users.ID " + "JOIN wp2_post_views ON wp2_posts.ID = wp2_post_views.id " + "WHERE wp2_post_views.period = 'total' " + ") table1 " + "JOIN " + "( " + "SELECT wp2_postmeta.post_id, " + "wp2_postmeta.meta_value AS image " + "FROM wp2_postmeta " + "WHERE wp2_postmeta.meta_key = 'sofbackend__sof_work_meta__postImage' " + ") table2 " + "ON table1.post_id = table2.post_id " + "ORDER BY visits DESC " + "LIMIT 10";
        this.db.query_db(query).then(function (data) {
            _promise.resolve(data);
        });
        return _promise.promise;
    };
    return ProductsService;
})();
exports.ProductsService = ProductsService;
;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZXMvcHJvZHVjdHMvcHJvZHVjdHMuc2VydmljZS50cyJdLCJuYW1lcyI6WyJQcm9kdWN0c1NlcnZpY2UiLCJQcm9kdWN0c1NlcnZpY2UuY29uc3RydWN0b3IiLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNOZXciLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNMaXN0IiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzTGlzdC5zaHVmZmxlIiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RCeUlkIiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzQnlBdXRob3IiLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNCeVNjaG9vbCIsIlByb2R1Y3RzU2VydmljZS5nZXRQcm9kdWN0c0J5T3B0aW9uc1NlYXJjaCIsIlByb2R1Y3RzU2VydmljZS5nZXRQcm9kdWN0c0J5U3ViY2F0ZWdvcnkwIiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzQnlTdWJjYXRlZ29yeTEiLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNCeVN0eWxlIiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzQnlTZXgiLCJQcm9kdWN0c1NlcnZpY2UuY3JlYXRlUHJvZHVjdCIsIlByb2R1Y3RzU2VydmljZS51cGRhdGVQcm9kdWN0IiwiUHJvZHVjdHNTZXJ2aWNlLmRlbGV0ZVByb2R1Y3QiLCJQcm9kdWN0c1NlcnZpY2UuY3JlYXRlQ29tbWVudCIsIlByb2R1Y3RzU2VydmljZS5nZXRQcm9kdWN0c0J5U2VhcmNoIiwiUHJvZHVjdHNTZXJ2aWNlLmdldFByb2R1Y3RzUmFua2luZ0J5TGlrZXMiLCJQcm9kdWN0c1NlcnZpY2UuZ2V0UHJvZHVjdHNSYW5raW5nQnlWaXNpdHMiXSwibWFwcGluZ3MiOiJBQUFBLGtEQUFrRDtBQUNsRCw0REFBNEQ7QUFFNUQsSUFBTyxDQUFDLFdBQVcsR0FBRyxDQUFDLENBQUM7QUFDeEIsSUFBTyxVQUFVLFdBQVcsa0NBQWtD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QTFCQTtRQUNJbUIsSUFBSUEsUUFBUUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsS0FBS0EsRUFBRUEsQ0FBQ0E7UUFDekJBLElBQUlBLEtBQUtBLEdBQUdBLGdCQUFnQkEsR0FDaEJBLElBQUlBLEdBQ0pBLGtDQUFrQ0EsR0FDbENBLGlDQUFpQ0EsR0FDakNBLG1DQUFtQ0EsR0FDbkNBLG9DQUFvQ0EsR0FDcENBLGlDQUFpQ0EsR0FDakNBLG1CQUFtQkEsR0FDbkJBLHlEQUF5REEsR0FDekRBLDBEQUEwREEsR0FDMURBLHdDQUF3Q0EsR0FDeENBLFdBQVdBLEdBQ1hBLE9BQU9BLEdBQ1BBLElBQUlBLEdBQ0pBLCtCQUErQkEsR0FDL0JBLG1DQUFtQ0EsR0FDbkNBLG9CQUFvQkEsR0FDcEJBLHVFQUF1RUEsR0FDdkVBLFdBQVdBLEdBQ1hBLHFDQUFxQ0EsR0FDckNBLHVCQUF1QkEsR0FDdkJBLFVBQVVBLENBQUNBO1FBQ3ZCQSxJQUFJQSxDQUFDQSxFQUFFQSxDQUFDQSxRQUFRQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUNsQkEsSUFBSUEsQ0FBQ0EsVUFBQ0EsSUFBSUE7WUFDUEEsUUFBUUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDM0JBLENBQUNBLENBQUNBLENBQUNBO1FBRVBBLE1BQU1BLENBQUNBLFFBQVFBLENBQUNBLE9BQU9BLENBQUNBO0lBQzVCQSxDQUFDQTtJQUVMbkIsc0JBQUNBO0FBQURBLENBcGpCQSxBQW9qQkNBLElBQUE7QUFwakJZLHVCQUFlLEdBQWYsZUFvakJaLENBQUE7QUFBQSxDQUFDIiwiZmlsZSI6Im1vZHVsZXMvcHJvZHVjdHMvcHJvZHVjdHMuc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi8uLi90eXBpbmdzL3RzZC5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9jb25uZWN0aW9uL2Nvbm5lY3Rpb24uc2VydmljZS50c1wiIC8+XG5cbmltcG9ydCBRID0gcmVxdWlyZShcInFcIik7XG5pbXBvcnQgY29ubmVjdGlvbiA9IHJlcXVpcmUoJy4uL2Nvbm5lY3Rpb24vY29ubmVjdGlvbi5zZXJ2aWNlJylcbmltcG9ydCBhdXRoID0gcmVxdWlyZShcIi4uL2F1dGgvYXV0aC5zZXJ2aWNlXCIpXG5pbXBvcnQgbWV0YWRhdGEgPSByZXF1aXJlKFwiLi4vbWV0YWRhdGEvbWV0YWRhdGEuc2VydmljZVwiKTtcblxudmFyIGF1dGhTZXJ2ID0gbmV3IGF1dGguQXV0aFNlcnZpY2UoKTtcbnZhciBtZXRhZGF0YVNlcnYgPSBuZXcgbWV0YWRhdGEuTWV0YWRhdGFTZXJ2aWNlKCk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVByb2R1Y3RzU2VydmljZSB7XG4gICAgLy8gR0VUXG4gICAgZ2V0UHJvZHVjdHNOZXcocGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldFByb2R1Y3RzTGlzdChwYWdlKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdEJ5SWQocHJvZHVjdElkKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNCeUF1dGhvcihhdXRob3JJZCwgcGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldFByb2R1Y3RzQnlTY2hvb2woc2Nob29sSWQsIHBhZ2UpOiBRLklQcm9taXNlPHt9PjtcbiAgICBnZXRQcm9kdWN0c0J5U3ViY2F0ZWdvcnkwKHN1YmNhdGVnb3J5MElkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNCeVN1YmNhdGVnb3J5MShzdWJjYXRlZ29yeTFJZCwgcGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldFByb2R1Y3RzQnlTdHlsZShzdHlsZUlkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNCeVNleChzZXhJZCwgcGFnZSk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldFByb2R1Y3RzQnlTZWFyY2goc2VhcmNoLCBwYWdlKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNCeU9wdGlvbnNTZWFyY2goc2VhcmNoLCBzdWJjYXRlZ29yeTAsIHN1YmNhdGVnb3J5MSwgc3R5bGUsIHNleCwgc2Nob29sKTogUS5JUHJvbWlzZTx7fT47XG4gICAgZ2V0UHJvZHVjdHNSYW5raW5nQnlMaWtlcygpOiBRLklQcm9taXNlPHt9PjtcbiAgICBnZXRQcm9kdWN0c1JhbmtpbmdCeVZpc2l0cygpOiBRLklQcm9taXNlPHt9PjtcbiAgICAvLyBQT1NUXG4gICAgY3JlYXRlUHJvZHVjdChub25jZSwgYXV0aG9yLCB0aXRsZSwgY29udGVudCwgc3RhdHVzLCBzY2hvb2wsIHN1YmNhdGVnb3J5MCwgc3ViY2F0ZWdvcnkxLCBzdHlsZXMpOiBRLklQcm9taXNlPHt9PjtcbiAgICBjcmVhdGVDb21tZW50KHByb2R1Y3RJZCwgY29va2llLCBjb250ZW50KTogUS5JUHJvbWlzZTx7fT47XG4gICAgLy8gUFVUXG4gICAgdXBkYXRlUHJvZHVjdChub25jZSwgcHJvZHVjdElkLCBhdXRob3IsIHRpdGxlLCBjb250ZW50LCBzdGF0dXMsIGNhdGVnb3JpZXMsIHRhZ3MpOiBRLklQcm9taXNlPHt9PjtcbiAgICAvLyBERUxFVEVcbiAgICBkZWxldGVQcm9kdWN0KG5vbmNlLCBwcm9kdWN0SWQpOiBRLklQcm9taXNlPHt9Pjtcbn1cblxudmFyIGluQXJyYXkgPSBmdW5jdGlvbihteUFycmF5LCBteVZhbHVlKSB7XG4gICAgdmFyIGluQXJyYXkgPSBmYWxzZTtcbiAgICBteUFycmF5Lm1hcChmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgaWYgKGtleSA9PT0gbXlWYWx1ZSkge1xuICAgICAgICAgICAgaW5BcnJheSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gaW5BcnJheTtcbn07XG5cbmV4cG9ydCBjbGFzcyBQcm9kdWN0c1NlcnZpY2UgaW1wbGVtZW50cyBJUHJvZHVjdHNTZXJ2aWNlIHtcbiAgICBwcml2YXRlIGRiID0gY29ubmVjdGlvbi5zZXJ2aWNlO1xuXG4gICAgZ2V0UHJvZHVjdHNOZXcocGFnZSk6IFEuSVByb21pc2U8e30+IHtcbiAgICAgICAgdmFyIF9saXN0UHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgdGhpcy5kYi5xdWVyeSgnY29yZS8/anNvbj1nZXRfcmVjZW50X3Bvc3RzJmNvdW50PTQmcGFnZT0nICsgcGFnZSlcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIF9wb3N0QXV0aG9yUG9wdWxhdGUgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgX3Bvc3RNZXRhZGF0YVBvcHVsYXRlID0gW107XG5cbiAgICAgICAgICAgICAgICByZXN1bHRzWydwb3N0cyddLmZvckVhY2goKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aG9yUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgX3Bvc3RBdXRob3JQb3B1bGF0ZS5wdXNoKGF1dGhvclByb21pc2UucHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgICAgIF9wb3N0TWV0YWRhdGFQb3B1bGF0ZS5wdXNoKG1ldGFkYXRhUHJvbWlzZS5wcm9taXNlKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBhdXRob3IncyBhdmF0YXJcbiAgICAgICAgICAgICAgICAgICAgYXV0aFNlcnYuZ2V0VXNlckF2YXRhcihyZXN1bHQuYXV0aG9yLmlkLCBcInRodW1iXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsnYXV0aG9yJ11bJ2F2YXRhciddID0gZGF0YVsnYXZhdGFyJ107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yUHJvbWlzZS5yZXNvbHZlKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wdWxhdGUgbWV0YWRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVNlcnYuZ2V0UHJvZHVjdE1ldGFkYXRhKHJlc3VsdC5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ21ldGFkYXRhJ10gPSBkYXRhMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhUHJvbWlzZS5yZXNvbHZlKGRhdGEyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBRLmFsbChfcG9zdEF1dGhvclBvcHVsYXRlLmNvbmNhdChfcG9zdE1ldGFkYXRhUG9wdWxhdGUpKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigodmFsdWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlzdFByb21pc2UucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gX2xpc3RQcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG4gICAgZ2V0UHJvZHVjdHNMaXN0KHBhZ2UpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHZhciBfbGlzdFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHZhciBjb3VudCA9IDY7XG4gICAgICAgIHRoaXMuZGIucXVlcnkoJ2NvcmUvP2pzb249Z2V0X3Bvc3RzJmNvdW50PScgKyBjb3VudCArICcmcGFnZT0nICsgcGFnZSlcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XG5cbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzaHVmZmxlKG8pIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiwgeCwgaSA9IG8ubGVuZ3RoOyBpOyBqID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogaSksIHggPSBvWy0taV0sIG9baV0gPSBvW2pdLCBvW2pdID0geCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2h1ZmZsZWQgPSBzaHVmZmxlKHJlc3VsdHNbJ3Bvc3RzJ10pO1xuXG4gICAgICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXSA9IHNodWZmbGVkO1xuICAgICAgICAgICAgICAgIHZhciBfcG9zdEF1dGhvclBvcHVsYXRlID0gW107XG4gICAgICAgICAgICAgICAgdmFyIF9wb3N0TWV0YWRhdGFQb3B1bGF0ZSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXS5mb3JFYWNoKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF1dGhvclByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXRhZGF0YVByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIF9wb3N0QXV0aG9yUG9wdWxhdGUucHVzaChhdXRob3JQcm9taXNlLnByb21pc2UpO1xuICAgICAgICAgICAgICAgICAgICBfcG9zdE1ldGFkYXRhUG9wdWxhdGUucHVzaChtZXRhZGF0YVByb21pc2UucHJvbWlzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcG9wdWxhdGUgYXV0aG9yJ3MgYXZhdGFyXG4gICAgICAgICAgICAgICAgICAgIGF1dGhTZXJ2LmdldFVzZXJBdmF0YXIocmVzdWx0LmF1dGhvci5pZCwgXCJ0aHVtYlwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ2F1dGhvciddWydhdmF0YXInXSA9IGRhdGFbJ2F2YXRhciddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvclByb21pc2UucmVzb2x2ZShkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcHVsYXRlIG1ldGFkYXRhZ2lcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVNlcnYuZ2V0UHJvZHVjdE1ldGFkYXRhKHJlc3VsdC5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ21ldGFkYXRhJ10gPSBkYXRhMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhUHJvbWlzZS5yZXNvbHZlKGRhdGEyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBRLmFsbChfcG9zdEF1dGhvclBvcHVsYXRlLmNvbmNhdChfcG9zdE1ldGFkYXRhUG9wdWxhdGUpKVxuICAgICAgICAgICAgICAgICAgICAudGhlbigodmFsdWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlzdFByb21pc2UucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gX2xpc3RQcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG4gICAgZ2V0UHJvZHVjdEJ5SWQocHJvZHVjdElkKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX3Byb2R1Y3RQcm9taXNlID0gUS5kZWZlcigpO1xuICAgICAgICB0aGlzLmRiLnF1ZXJ5KCdjb3JlL2dldF9wb3N0Lz9pZD0nICsgcHJvZHVjdElkKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBfcHJvbWlzZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIC8vIHNhdmUgdmlzaXRcbiAgICAgICAgICAgICAgICB2YXIgc2F2ZVZpc2l0UHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBfcHJvbWlzZXMucHVzaChzYXZlVmlzaXRQcm9taXNlLnByb21pc2UpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHZpc2l0UXVlcnkgPSBcIklOU0VSVCBJTlRPIHdwMl9wb3N0X3ZpZXdzIChpZCwgdHlwZSwgcGVyaW9kLCBjb3VudCkgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJWQUxVRVMgKFwiICsgcHJvZHVjdElkICsgXCIsNCwndG90YWwnLDEpIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiT04gRFVQTElDQVRFIEtFWSBVUERBVEUgY291bnQ9Y291bnQrMVwiO1xuICAgICAgICAgICAgICAgIHRoaXMuZGIucXVlcnlfZGIodmlzaXRRdWVyeSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZVZpc2l0UHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBwcm9kdWN0IHZpc2l0c1xuICAgICAgICAgICAgICAgIHZhciB2aWV3VmlzaXRzUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBfcHJvbWlzZXMucHVzaCh2aWV3VmlzaXRzUHJvbWlzZS5wcm9taXNlKTtcblxuICAgICAgICAgICAgICAgIHZhciB2aXNpdFF1ZXJ5ID0gXCJTRUxFQ1QgY291bnQgRlJPTSB3cDJfcG9zdF92aWV3cyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIldIRVJFIGlkPVwiICsgcHJvZHVjdElkICsgXCIgQU5EIHR5cGU9NCBBTkQgcGVyaW9kPSd0b3RhbCdcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmRiLnF1ZXJ5X2RiKHZpc2l0UXVlcnkpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ3Bvc3QnXVsndmlzaXRzJ10gPSBkYXRhWzBdWydjb3VudCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlld1Zpc2l0c1Byb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8gcG9wdWxhdGUgYXV0aG9yJ3MgYXZhdGFyXG4gICAgICAgICAgICAgICAgYXV0aFNlcnYuZ2V0VXNlckF2YXRhcihyZXN1bHRbJ3Bvc3QnXVsnYXV0aG9yJ11bJ2lkJ10sIFwidGh1bWJcIilcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdXRob3JQcm9taXNlID0gUS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3Byb21pc2VzLnB1c2goYXV0aG9yUHJvbWlzZS5wcm9taXNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsncG9zdCddWydhdXRob3InXVsnYXZhdGFyJ10gPSBkYXRhWydhdmF0YXInXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvclByb21pc2UucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsncG9zdCddWydjb21tZW50cyddICYmIHJlc3VsdFsncG9zdCddWydjb21tZW50cyddLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgZWFjaCBjb21tZW50XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdFsncG9zdCddWydjb21tZW50cyddLmZvckVhY2goKGNvbW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21tZW50UHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9wcm9taXNlcy5wdXNoKGNvbW1lbnRQcm9taXNlLnByb21pc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBjb21tZW50cyBhdmF0YXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhTZXJ2LmdldFVzZXJBdmF0YXIoY29tbWVudC5hdXRob3IuaWQsIFwidGh1bWJcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoYXZhdGFyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnRbJ2F1dGhvciddWydhdmF0YXInXSA9IGF2YXRhclsnYXZhdGFyJ107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnRQcm9taXNlLnJlc29sdmUoYXZhdGFyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBtZXRhZGF0YVxuICAgICAgICAgICAgICAgIG1ldGFkYXRhU2Vydi5nZXRQcm9kdWN0TWV0YWRhdGEocmVzdWx0Wydwb3N0J11bJ2lkJ10pXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChtZXRhZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9wcm9taXNlcy5wdXNoKG1ldGFkYXRhUHJvbWlzZS5wcm9taXNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsncG9zdCddWydtZXRhZGF0YSddID0gbWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVByb21pc2UucmVzb2x2ZShtZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICBRLmFsbChfcHJvbWlzZXMpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKCh2YWx1ZXMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9wcm9kdWN0UHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gX3Byb2R1Y3RQcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG4gICAgZ2V0UHJvZHVjdHNCeUF1dGhvcihhdXRob3JJZCk6IFEuSVByb21pc2U8e30+IHtcbiAgICAgICAgdmFyIF9wcm9taXNlID0gUS5kZWZlcigpO1xuICAgICAgICB0aGlzLmRiLnF1ZXJ5KCdjb3JlL2dldF9hdXRob3JfcG9zdHMvP2NvdW50PTQmaWQ9JyArIGF1dGhvcklkKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3VsdHMpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgX3Bvc3RBdXRob3JQb3B1bGF0ZSA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBfcG9zdE1ldGFkYXRhUG9wdWxhdGUgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVyUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBfcG9zdEF1dGhvclBvcHVsYXRlLnB1c2goaGVhZGVyUHJvbWlzZS5wcm9taXNlKTtcblxuICAgICAgICAgICAgICAgIC8vIHBvcHVsYXRlIGhlYWRlciBhdmF0YXJcbiAgICAgICAgICAgICAgICBhdXRoU2Vydi5nZXRVc2VyQXZhdGFyKHJlc3VsdHNbJ2F1dGhvciddWydpZCddLCBcInRodW1iXCIpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzWydhdXRob3InXVsnYXZhdGFyJ10gPSBkYXRhWydhdmF0YXInXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlclByb21pc2UucmVzb2x2ZShkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXS5mb3JFYWNoKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aG9yUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWV0YWRhdGFQcm9taXNlID0gUS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wb3N0QXV0aG9yUG9wdWxhdGUucHVzaChhdXRob3JQcm9taXNlLnByb21pc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wb3N0TWV0YWRhdGFQb3B1bGF0ZS5wdXNoKG1ldGFkYXRhUHJvbWlzZS5wcm9taXNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcHVsYXRlIGF1dGhvcidzIGF2YXRhclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsnYXV0aG9yJ11bJ2F2YXRhciddID0gZGF0YVsnYXZhdGFyJ107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yUHJvbWlzZS5yZXNvbHZlKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcG9wdWxhdGUgbWV0YWRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVNlcnYuZ2V0UHJvZHVjdE1ldGFkYXRhKHJlc3VsdC5pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ21ldGFkYXRhJ10gPSBkYXRhMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhUHJvbWlzZS5yZXNvbHZlKGRhdGEyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFEuYWxsKF9wb3N0QXV0aG9yUG9wdWxhdGUuY29uY2F0KF9wb3N0TWV0YWRhdGFQb3B1bGF0ZSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHZhbHVlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcHJvbWlzZS5yZXNvbHZlKHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3Byb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0c0J5U2Nob29sKHNjaG9vbElkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX2xpc3RQcm9taXNlID0gUS5kZWZlcigpO1xuICAgICAgICB0aGlzLmRiLnF1ZXJ5KCdjb3JlLz9qc29uPWdldF9wb3N0cyZjb3VudD0yMDAnKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3VsdHMpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgcG9zdHMgPSByZXN1bHRzWydwb3N0cyddO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5kYi5xdWVyeV9kYihcIlNFTEVDVCB1c2VyX2lkIEZST00gd3AyX2JwX3hwcm9maWxlX2RhdGEgV0hFUkUgdmFsdWU9J1wiICsgc2Nob29sSWQgKyBcIicgQU5EIGZpZWxkX2lkPTRcIilcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWRzID0gW11cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZHMucHVzaChkYXRhW2ldLnVzZXJfaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2Nob29sUG9zdHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogaW4gcG9zdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5BcnJheSh1c2VySWRzLCBwb3N0c1tqXS5hdXRob3IuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjaG9vbFBvc3RzLnB1c2gocG9zdHNbal0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXSA9IHNjaG9vbFBvc3RzO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1snc2Nob29sJ10gPSBzY2hvb2xJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNbJ2NvdW50J10gPSBzY2hvb2xQb3N0cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzWydjb3VudF90b3RhbCddID0gc2Nob29sUG9zdHMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlzdFByb21pc2UucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIHJldHVybiBfbGlzdFByb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0c0J5T3B0aW9uc1NlYXJjaChzZWFyY2gsIHN1YmNhdGVnb3J5MCwgc3ViY2F0ZWdvcnkxLCBzdHlsZSwgc2V4KTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX3Byb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIGlmIChzZWFyY2ggPT0gJ251bGwnKSBzZWFyY2ggPSAnJztcbiAgICAgICAgaWYgKHN1YmNhdGVnb3J5MCA9PSAnbnVsbCcpIHNlYXJjaCA9ICcnO1xuICAgICAgICBpZiAoc3ViY2F0ZWdvcnkxID09ICdudWxsJykgc2VhcmNoID0gJyc7XG4gICAgICAgIGlmIChzdHlsZSA9PSAnbnVsbCcpIHNlYXJjaCA9ICcnO1xuICAgICAgICBpZiAoc2V4ID09ICdudWxsJykgc2VhcmNoID0gJyc7XG4gICAgICAgIHZhciBxdWVyeSA9IFwiU0VMRUNUIHBvc3RfZGF0YS5wb3N0X2lkLCBwb3N0X2RhdGEudGl0bGUsIHBvc3RfZGF0YS5kYXRlLCBwb3N0X2RhdGEuYXV0aG9yLCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiaW1hZ2UuaW1hZ2UsIHN1YmNhdGVnb3J5MC5zdWJjYXRlZ29yeTAsIHN1YmNhdGVnb3J5MS5zdWJjYXRlZ29yeTEsIHN0eWxlLnN0eWxlLCBzZXguc2V4IFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJGUk9NIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKFNFTEVDVCB3cDJfcG9zdHMuSUQgQVMgcG9zdF9pZCwgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cDJfcG9zdHMucG9zdF90aXRsZSBBUyB0aXRsZSwgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cDJfcG9zdHMucG9zdF9kYXRlX2dtdCBBUyBkYXRlLCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndwMl91c2Vycy5kaXNwbGF5X25hbWUgQVMgYXV0aG9yLCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndwMl91c2Vycy5JRCBBUyBhdXRob3JfaWQgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJGUk9NIGB3cDJfcG9zdHNgIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiSk9JTiB3cDJfdXNlcnMgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJPTiB3cDJfcG9zdHMucG9zdF9hdXRob3IgPSB3cDJfdXNlcnMuSUQgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdHMucG9zdF90aXRsZSBMSUtFICclXCIgKyBzZWFyY2ggKyBcIiUnIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKSBwb3N0X2RhdGEgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIkpPSU4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIoU0VMRUNUIHdwMl9wb3N0bWV0YS5wb3N0X2lkLCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndwMl9wb3N0bWV0YS5tZXRhX3ZhbHVlIEFTIGltYWdlIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRlJPTSB3cDJfcG9zdG1ldGEgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdG1ldGEubWV0YV9rZXkgPSAnc29mYmFja2VuZF9fc29mX3dvcmtfbWV0YV9fcG9zdEltYWdlJyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIikgaW1hZ2UgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9OIHBvc3RfZGF0YS5wb3N0X2lkID0gaW1hZ2UucG9zdF9pZCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiSk9JTiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIihTRUxFQ1Qgd3AyX3Bvc3RtZXRhLnBvc3RfaWQsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3AyX3Bvc3RtZXRhLm1ldGFfdmFsdWUgQVMgc3ViY2F0ZWdvcnkwIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRlJPTSB3cDJfcG9zdG1ldGEgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdG1ldGEubWV0YV9rZXkgPSAnc29mYmFja2VuZF9fc29mX3dvcmtfbWV0YV9fY2F0ZWdvcnlfMCcgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJBTkQgd3AyX3Bvc3RtZXRhLm1ldGFfdmFsdWUgTElLRSAnJVwiICsgc3ViY2F0ZWdvcnkwICsgXCIlJyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIikgc3ViY2F0ZWdvcnkwIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJPTiBwb3N0X2RhdGEucG9zdF9pZCA9IHN1YmNhdGVnb3J5MC5wb3N0X2lkIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJKT0lOIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKFNFTEVDVCB3cDJfcG9zdG1ldGEucG9zdF9pZCwgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3cDJfcG9zdG1ldGEubWV0YV92YWx1ZSBBUyBzdWJjYXRlZ29yeTEgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJGUk9NIHdwMl9wb3N0bWV0YSBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIldIRVJFIHdwMl9wb3N0bWV0YS5tZXRhX2tleSA9ICdzb2ZiYWNrZW5kX19zb2Zfd29ya19tZXRhX19jYXRlZ29yeV8xJyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkFORCB3cDJfcG9zdG1ldGEubWV0YV92YWx1ZSBMSUtFICclXCIgKyBzdWJjYXRlZ29yeTEgKyBcIiUnIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKSBzdWJjYXRlZ29yeTEgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9OIHBvc3RfZGF0YS5wb3N0X2lkID0gc3ViY2F0ZWdvcnkxLnBvc3RfaWQgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIkpPSU4gXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCIoU0VMRUNUIHdwMl9wb3N0bWV0YS5wb3N0X2lkLCBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndwMl9wb3N0bWV0YS5tZXRhX3ZhbHVlIEFTIHN0eWxlIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRlJPTSB3cDJfcG9zdG1ldGEgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdG1ldGEubWV0YV9rZXkgPSAnc29mYmFja2VuZF9fc29mX3dvcmtfbWV0YV9fc3R5bGUnIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiQU5EIHdwMl9wb3N0bWV0YS5tZXRhX3ZhbHVlIExJS0UgJyVcIiArIHN0eWxlICsgXCIlJyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIikgc3R5bGUgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9OIHBvc3RfZGF0YS5wb3N0X2lkID0gc3R5bGUucG9zdF9pZCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiSk9JTiBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIihTRUxFQ1Qgd3AyX3Bvc3RtZXRhLnBvc3RfaWQsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid3AyX3Bvc3RtZXRhLm1ldGFfdmFsdWUgQVMgc2V4IFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRlJPTSB3cDJfcG9zdG1ldGEgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdG1ldGEubWV0YV9rZXkgPSAnc29mYmFja2VuZF9fc29mX3dvcmtfbWV0YV9fc2V4JyBcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkFORCB3cDJfcG9zdG1ldGEubWV0YV92YWx1ZSBMSUtFICclXCIgKyBzZXggKyBcIiUnIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiKSBzZXggXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9OIHBvc3RfZGF0YS5wb3N0X2lkID0gc2V4LnBvc3RfaWQgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9SREVSIEJZIHBvc3RfaWQgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIkxJTUlUIDEwXCI7XG4gICAgICAgIHRoaXMuZGIucXVlcnlfZGIocXVlcnkpXG4gICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICB2YXIgZGF0YUpzb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcblxuICAgICAgICAgICAgdmFyIF9wb3N0QXV0aG9yUG9wdWxhdGUgPSBbXTtcbiAgICAgICAgICAgIHZhciBfcG9zdE1ldGFkYXRhUG9wdWxhdGUgPSBbXTtcblxuICAgICAgICAgICAgZGF0YUpzb24uZm9yRWFjaCgocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGF1dGhvclByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1ldGFkYXRhUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBfcG9zdEF1dGhvclBvcHVsYXRlLnB1c2goYXV0aG9yUHJvbWlzZS5wcm9taXNlKTtcbiAgICAgICAgICAgICAgICBfcG9zdE1ldGFkYXRhUG9wdWxhdGUucHVzaChtZXRhZGF0YVByb21pc2UucHJvbWlzZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBhdXRob3IncyBhdmF0YXJcbiAgICAgICAgICAgICAgICBhdXRoU2Vydi5nZXRVc2VyQXZhdGFyKHJlc3VsdFsnYXV0aG9yX2lkJ10sIFwidGh1bWJcIilcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsnYXV0aG9yX2F2YXRhciddID0gZGF0YVsnYXZhdGFyJ107XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRob3JQcm9taXNlLnJlc29sdmUoZGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcHVsYXRlIG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YVNlcnYuZ2V0UHJvZHVjdE1ldGFkYXRhKHJlc3VsdC5wb3N0X2lkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChkYXRhMikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ21ldGFkYXRhJ10gPSBkYXRhMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFQcm9taXNlLnJlc29sdmUoZGF0YTIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgUS5hbGwoX3Bvc3RBdXRob3JQb3B1bGF0ZS5jb25jYXQoX3Bvc3RNZXRhZGF0YVBvcHVsYXRlKSlcbiAgICAgICAgICAgICAgICAudGhlbigodmFsdWVzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIF9wcm9taXNlLnJlc29sdmUoZGF0YUpzb24pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gX3Byb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0c0J5U3ViY2F0ZWdvcnkwKHN1YmNhdGVnb3J5MElkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT4gwqB7XG4gICAgICAgIHZhciBfbGlzdFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHRoaXMuZGIucXVlcnkoJ2NvcmUvP2pzb249Z2V0X3Bvc3RzJmNvdW50PTIwMCcpXG4gICAgICAgICAgICAudGhlbigocmVzdWx0cykgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBwb3N0cyA9IHJlc3VsdHNbJ3Bvc3RzJ107XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViY2F0ZWdvcnkwUG9zdHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHBvc3RzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3RzW2ldWydjdXN0b21fZmllbGRzJ11bJ3NvZmJhY2tlbmRfX3NvZl93b3JrX21ldGFfX2NhdGVnb3J5XzAnXSA9PSBzdWJjYXRlZ29yeTBJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViY2F0ZWdvcnkwUG9zdHMucHVzaChwb3N0c1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ3Bvc3RzJ10gPSBzdWJjYXRlZ29yeTBQb3N0cztcbiAgICAgICAgICAgICAgICByZXN1bHRzWydzdWJjYXRlZ29yeTAnXSA9IHN1YmNhdGVnb3J5MElkO1xuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ2NvdW50J10gPSBzdWJjYXRlZ29yeTBQb3N0cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgcmVzdWx0c1snY291bnRfdG90YWwnXSA9IHN1YmNhdGVnb3J5MFBvc3RzLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIF9saXN0UHJvbWlzZS5yZXNvbHZlKHJlc3VsdHMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIF9saXN0UHJvbWlzZS5wcm9taXNlO1xuICAgIH1cblxuICAgIGdldFByb2R1Y3RzQnlTdWJjYXRlZ29yeTEoc3ViY2F0ZWdvcnkxSWQsIHBhZ2UpOiBRLklQcm9taXNlPHt9PiDCoHtcbiAgICAgICAgdmFyIF9saXN0UHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgdGhpcy5kYi5xdWVyeSgnY29yZS8/anNvbj1nZXRfcG9zdHMmY291bnQ9MjAwJylcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIHBvc3RzID0gcmVzdWx0c1sncG9zdHMnXTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJjYXRlZ29yeTFQb3N0cyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcG9zdHMpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocG9zdHNbaV1bJ2N1c3RvbV9maWVsZHMnXVsnc29mYmFja2VuZF9fc29mX3dvcmtfbWV0YV9fY2F0ZWdvcnlfMSddID09IHN1YmNhdGVnb3J5MUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJjYXRlZ29yeTFQb3N0cy5wdXNoKHBvc3RzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXSA9IHN1YmNhdGVnb3J5MVBvc3RzO1xuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ3N1YmNhdGVnb3J5MSddID0gc3ViY2F0ZWdvcnkxSWQ7XG4gICAgICAgICAgICAgICAgcmVzdWx0c1snY291bnQnXSA9IHN1YmNhdGVnb3J5MVBvc3RzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByZXN1bHRzWydjb3VudF90b3RhbCddID0gc3ViY2F0ZWdvcnkxUG9zdHMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgX2xpc3RQcm9taXNlLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICByZXR1cm4gX2xpc3RQcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG4gICAgZ2V0UHJvZHVjdHNCeVN0eWxlKHN0eWxlSWQsIHBhZ2UpOiBRLklQcm9taXNlPHt9PiDCoHtcbiAgICAgICAgdmFyIF9saXN0UHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgdGhpcy5kYi5xdWVyeSgnY29yZS8/anNvbj1nZXRfcG9zdHMmY291bnQ9MjAwJylcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIHBvc3RzID0gcmVzdWx0c1sncG9zdHMnXTtcblxuICAgICAgICAgICAgICAgIHZhciBzdHlsZVBvc3RzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBwb3N0cykge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwb3N0c1tpXVsnY3VzdG9tX2ZpZWxkcyddWydzb2ZiYWNrZW5kX19zb2Zfd29ya19tZXRhX19zdHlsZSddID09IHN0eWxlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlUG9zdHMucHVzaChwb3N0c1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ3Bvc3RzJ10gPSBzdHlsZVBvc3RzO1xuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ3N0eWxlJ10gPSBzdHlsZUlkO1xuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ2NvdW50J10gPSBzdHlsZVBvc3RzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByZXN1bHRzWydjb3VudF90b3RhbCddID0gc3R5bGVQb3N0cy5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBfbGlzdFByb21pc2UucmVzb2x2ZShyZXN1bHRzKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIHJldHVybiBfbGlzdFByb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0c0J5U2V4KHNleElkLCBwYWdlKTogUS5JUHJvbWlzZTx7fT4gwqB7XG4gICAgICAgIHZhciBfbGlzdFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHRoaXMuZGIucXVlcnkoJ2NvcmUvP2pzb249Z2V0X3Bvc3RzJmNvdW50PTIwMCcpXG4gICAgICAgICAgICAudGhlbigocmVzdWx0cykgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBwb3N0cyA9IHJlc3VsdHNbJ3Bvc3RzJ107XG5cbiAgICAgICAgICAgICAgICB2YXIgc2V4UG9zdHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHBvc3RzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBvc3RzW2ldWydjdXN0b21fZmllbGRzJ11bJ3NvZmJhY2tlbmRfX3NvZl93b3JrX21ldGFfX3NleCddID09IHNleElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXhQb3N0cy5wdXNoKHBvc3RzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXSA9IHNleFBvc3RzO1xuICAgICAgICAgICAgICAgIHJlc3VsdHNbJ3NleCddID0gc2V4SWQ7XG4gICAgICAgICAgICAgICAgcmVzdWx0c1snY291bnQnXSA9IHNleFBvc3RzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICByZXN1bHRzWydjb3VudF90b3RhbCddID0gc2V4UG9zdHMubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgX2xpc3RQcm9taXNlLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICByZXR1cm4gX2xpc3RQcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG4gICAgY3JlYXRlUHJvZHVjdChub25jZSwgYXV0aG9yLCB0aXRsZSwgY29udGVudCwgc3RhdHVzLCBzY2hvb2wsIHN1YmNhdGVnb3J5MCwgc3ViY2F0ZWdvcnkxLCBzdHlsZXMpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLnF1ZXJ5KCdwb3N0cy9jcmVhdGVfcG9zdC8/bm9uY2U9JyArIG5vbmNlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZhdXRob3I9JyArIGF1dGhvciArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmdGl0bGU9JyArIHRpdGxlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZjb250ZW50PScgKyBjb250ZW50ICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZzdGF0dXM9JyArIHN0YXR1cylcbiAgICAgICAgICAgIC50aGVuKChwb3N0KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocG9zdCk7XG5cbiAgICAgICAgICAgICAgICAvLyBGQUxUQSBHVUFSREFSIFNDSE9PTCwgU1VCQ0FURUdPUlksIFNUWUxFU1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvc3Q7XG4gICAgICAgICAgICB9KVxuICAgIH1cblxuICAgIHVwZGF0ZVByb2R1Y3Qobm9uY2UsIHByb2R1Y3RJZCwgYXV0aG9yLCB0aXRsZSwgY29udGVudCwgc3RhdHVzLCBjYXRlZ29yaWVzLCB0YWdzKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5xdWVyeSgncG9zdHMvdXBkYXRlX3Bvc3QvP25vbmNlPScgKyBub25jZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmaWQ9JyArIHByb2R1Y3RJZCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmYXV0aG9yPScgKyBhdXRob3IgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnRpdGxlPScgKyB0aXRsZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmY29udGVudD0nICsgY29udGVudCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmc3RhdHVzPScgKyBzdGF0dXMgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJmNhdGVnb3JpZXM9JyArIGNhdGVnb3JpZXMgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJnRhZ3M9JyArIHRhZ3MpXG4gICAgfVxuXG4gICAgZGVsZXRlUHJvZHVjdChub25jZSwgcHJvZHVjdElkKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5xdWVyeSgncG9zdHMvZGVsZXRlX3Bvc3QvP25vbmNlPScgKyBub25jZSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmaWQ9JyArIHByb2R1Y3RJZClcbiAgICB9XG5cbiAgICBjcmVhdGVDb21tZW50KHByb2R1Y3RJZCwgY29va2llLCBjb250ZW50KTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kYi5xdWVyeSgndXNlci9wb3N0X2NvbW1lbnQvP3Bvc3RfaWQ9JyArIHByb2R1Y3RJZCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICcmY29va2llPScgKyBjb29raWUgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnJmNvbW1lbnRfc3RhdHVzPTEnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJyZjb250ZW50PScgKyBjb250ZW50KVxuICAgIH1cblxuICAgIGdldFByb2R1Y3RzQnlTZWFyY2goc2VhcmNoLCBwYWdlKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX3NlYXJjaFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHRoaXMuZGIucXVlcnkoJ2NvcmUvZ2V0X3NlYXJjaF9yZXN1bHRzLz9jb3VudD00JnNlYXJjaD0nICsgc2VhcmNoICtcbiAgICAgICAgICAgICcmcGFnZT0nICsgcGFnZSkudGhlbigocmVzdWx0cykgPT4ge1xuICAgICAgICAgICAgdmFyIF9wb3N0QXV0aG9yUG9wdWxhdGUgPSBbXTtcblxuICAgICAgICAgICAgcmVzdWx0c1sncG9zdHMnXS5mb3JFYWNoKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICB2YXIgYXV0aG9yUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICBfcG9zdEF1dGhvclBvcHVsYXRlLnB1c2goYXV0aG9yUHJvbWlzZS5wcm9taXNlKTtcbiAgICAgICAgICAgICAgICBhdXRoU2Vydi5nZXRVc2VyQXZhdGFyKHJlc3VsdC5hdXRob3IuaWQsIFwidGh1bWJcIilcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsnYXV0aG9yJ11bJ2F2YXRhciddPSBkYXRhWydhdmF0YXInXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvclByb21pc2UucmVzb2x2ZShkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGFTZXJ2LmdldFByb2R1Y3RNZXRhZGF0YShyZXN1bHQuaWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFsnbWV0YWRhdGEnXSA9IGRhdGEyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgUS5hbGwoX3Bvc3RBdXRob3JQb3B1bGF0ZSlcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIF9zZWFyY2hQcm9taXNlLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBfc2VhcmNoUHJvbWlzZS5wcm9taXNlO1xuICAgIH1cblxuICAgIGdldFByb2R1Y3RzUmFua2luZ0J5TGlrZXMoKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX3Jlc3BvbnNlUHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgdmFyIF9wcm9kdWN0c1Byb21pc2VzID0gW107XG4gICAgICAgIHZhciBfcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICBwb3N0cyA6IFtdXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIHF1ZXJ5ID0gXCJTRUxFQ1QgKiBGUk9NIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIoIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJTRUxFQ1Qgd3AyX3Bvc3RzLklEIEFTIHBvc3RfaWQsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJ3cDJfcG9zdHMucG9zdF90aXRsZSBBUyB0aXRsZSwgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIndwMl9wb3N0cy5wb3N0X2RhdGVfZ210IEFTIGRhdGUsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJ3cDJfcG9zdG1ldGEubWV0YV92YWx1ZSBBUyBsaWtlcywgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIndwMl91c2Vycy5kaXNwbGF5X25hbWUgQVMgYXV0aG9yIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJGUk9NIGB3cDJfcG9zdHNgIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJKT0lOIHdwMl91c2VycyBPTiB3cDJfcG9zdHMucG9zdF9hdXRob3IgPSB3cDJfdXNlcnMuSUQgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIkpPSU4gd3AyX3Bvc3RtZXRhIE9OIHdwMl9wb3N0cy5JRCA9IHdwMl9wb3N0bWV0YS5wb3N0X2lkIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdG1ldGEubWV0YV9rZXkgPSAnX2l0ZW1fbGlrZXMnIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIpIHRhYmxlMSBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiT1JERVIgQlkgbGlrZXMgREVTQyBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiTElNSVQgNVwiO1xuICAgICAgICB0aGlzLmRiLnF1ZXJ5X2RiKHF1ZXJ5KVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEgOiBhbnlbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaCgocHJvZHVjdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3Byb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIF9wcm9kdWN0c1Byb21pc2VzLnB1c2goX3Byb21pc2UucHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0UHJvZHVjdEJ5SWQocHJvZHVjdFsncG9zdF9pZCddKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9wcm9taXNlLnJlc29sdmUocmVzdWx0Wydwb3N0J10pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgUS5hbGwoX3Byb2R1Y3RzUHJvbWlzZXMpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVzcG9uc2VQcm9taXNlLnJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIF9yZXNwb25zZVByb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRQcm9kdWN0c1JhbmtpbmdCeVZpc2l0cygpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHZhciBfcHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgdmFyIHF1ZXJ5ID0gXCJTRUxFQ1QgKiBGUk9NIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIoIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJTRUxFQ1Qgd3AyX3Bvc3RzLklEIEFTIHBvc3RfaWQsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJ3cDJfcG9zdHMucG9zdF90aXRsZSBBUyB0aXRsZSwgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIndwMl9wb3N0cy5wb3N0X2RhdGVfZ210IEFTIGRhdGUsIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJ3cDJfdXNlcnMuZGlzcGxheV9uYW1lIEFTIGF1dGhvciwgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIndwMl9wb3N0X3ZpZXdzLmNvdW50IEFTIHZpc2l0cyBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiRlJPTSBgd3AyX3Bvc3RzYCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiSk9JTiB3cDJfdXNlcnMgT04gd3AyX3Bvc3RzLnBvc3RfYXV0aG9yID0gd3AyX3VzZXJzLklEIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJKT0lOIHdwMl9wb3N0X3ZpZXdzIE9OIHdwMl9wb3N0cy5JRCA9IHdwMl9wb3N0X3ZpZXdzLmlkIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdF92aWV3cy5wZXJpb2QgPSAndG90YWwnIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCIpIHRhYmxlMSBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiSk9JTiBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiKCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiU0VMRUNUIHdwMl9wb3N0bWV0YS5wb3N0X2lkLCBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwid3AyX3Bvc3RtZXRhLm1ldGFfdmFsdWUgQVMgaW1hZ2UgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIkZST00gd3AyX3Bvc3RtZXRhIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJXSEVSRSB3cDJfcG9zdG1ldGEubWV0YV9rZXkgPSAnc29mYmFja2VuZF9fc29mX3dvcmtfbWV0YV9fcG9zdEltYWdlJyBcIiArXG4gICAgICAgICAgICAgICAgICAgIFwiKSB0YWJsZTIgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9OIHRhYmxlMS5wb3N0X2lkID0gdGFibGUyLnBvc3RfaWQgXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIk9SREVSIEJZIHZpc2l0cyBERVNDIFwiICtcbiAgICAgICAgICAgICAgICAgICAgXCJMSU1JVCAxMFwiO1xuICAgICAgICB0aGlzLmRiLnF1ZXJ5X2RiKHF1ZXJ5KVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBfcHJvbWlzZS5yZXNvbHZlKGRhdGEpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIF9wcm9taXNlLnByb21pc2U7XG4gICAgfVxuXG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9