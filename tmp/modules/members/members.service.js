/// <reference path="../../../typings/tsd.d.ts" />
/// <reference path="../connection/connection.service.ts" />
var Q = require("q");
var connection = require('../connection/connection.service');
var Products = require('../products/products.service');
var avatar = require('../auth/avatar.service');
var productsServ = new Products.ProductsService();
var MembersService = (function () {
    function MembersService() {
        this.db = connection.service;
    }
    MembersService.prototype.getMembersList = function () {
        var _listPromise = Q.defer();
        this.db.query_db("SELECT id, display_name FROM wp2_users").then(function (data) {
            _listPromise.resolve(data);
        });
        return _listPromise.promise;
    };
    MembersService.prototype.getMemberById = function (memberId) {
        var _promise = Q.defer();
        var avatarService = new avatar.AvatarService();
        productsServ.getProductsByAuthor(memberId).then(function (result) {
            avatarService.getUserAvatar(memberId, "thumb").then(function (avatarInfo) {
                result['author']['avatar'] = avatarInfo['avatar'];
                _promise.resolve(result);
            });
        });
        return _promise.promise;
    };
    return MembersService;
})();
exports.MembersService = MembersService;
;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZXMvbWVtYmVycy9tZW1iZXJzLnNlcnZpY2UudHMiXSwibmFtZXMiOlsiTWVtYmVyc1NlcnZpY2UiLCJNZW1iZXJzU2VydmljZS5jb25zdHJ1Y3RvciIsIk1lbWJlcnNTZXJ2aWNlLmdldE1lbWJlcnNMaXN0IiwiTWVtYmVyc1NlcnZpY2UuZ2V0TWVtYmVyQnlJZCJdLCJtYXBwaW5ncyI6IkFBQUEsa0RBQWtEO0FBQ2xELDREQUE0RDtBQUU1RCxJQUFPLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQztBQUN4QixJQUFPLFVBQVUsV0FBVyxrQ0FBa0MsQ0FBQyxDQUFBO0FBQy9ELElBQU8sUUFBUSxXQUFXLDhCQUE4QixDQUFDLENBQUE7QUFFekQsSUFBTyxNQUFNLFdBQVcsd0JBQXdCLENBQUMsQ0FBQztBQUVsRCxJQUFJLFlBQVksR0FBRyxJQUFJLFFBQVEsQ0FBQyxlQUFlLEVBQUUsQ0FBQztBQVNsRCxJQUFhLGNBQWM7SUFBM0JBLFNBQWFBLGNBQWNBO1FBQ2ZDLE9BQUVBLEdBQUdBLFVBQVVBLENBQUNBLE9BQU9BLENBQUNBO0lBd0JwQ0EsQ0FBQ0E7SUF0QkdELHVDQUFjQSxHQUFkQTtRQUNJRSxJQUFJQSxZQUFZQSxHQUFHQSxDQUFDQSxDQUFDQSxLQUFLQSxFQUFFQSxDQUFDQTtRQUM3QkEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsUUFBUUEsQ0FBQ0Esd0NBQXdDQSxDQUFDQSxDQUNyREEsSUFBSUEsQ0FBQ0EsVUFBQ0EsSUFBSUE7WUFDUEEsWUFBWUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDL0JBLENBQUNBLENBQUNBLENBQUNBO1FBQ1BBLE1BQU1BLENBQUNBLFlBQVlBLENBQUNBLE9BQU9BLENBQUNBO0lBQ2hDQSxDQUFDQTtJQUVERixzQ0FBYUEsR0FBYkEsVUFBY0EsUUFBUUE7UUFDbEJHLElBQUlBLFFBQVFBLEdBQUdBLENBQUNBLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBO1FBQ3pCQSxJQUFJQSxhQUFhQSxHQUFHQSxJQUFJQSxNQUFNQSxDQUFDQSxhQUFhQSxFQUFFQSxDQUFDQTtRQUUvQ0EsWUFBWUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFBQSxNQUFNQTtZQUNsREEsYUFBYUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsUUFBUUEsRUFBRUEsT0FBT0EsQ0FBQ0EsQ0FDekNBLElBQUlBLENBQUNBLFVBQUFBLFVBQVVBO2dCQUNYQSxNQUFNQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQSxRQUFRQSxDQUFDQSxHQUFHQSxVQUFVQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQTtnQkFDbkRBLFFBQVFBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO1lBQzdCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNYQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUNIQSxNQUFNQSxDQUFDQSxRQUFRQSxDQUFDQSxPQUFPQSxDQUFDQTtJQUM1QkEsQ0FBQ0E7SUFDTEgscUJBQUNBO0FBQURBLENBekJBLEFBeUJDQSxJQUFBO0FBekJZLHNCQUFjLEdBQWQsY0F5QlosQ0FBQTtBQUFBLENBQUMiLCJmaWxlIjoibW9kdWxlcy9tZW1iZXJzL21lbWJlcnMuc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi8uLi90eXBpbmdzL3RzZC5kLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9jb25uZWN0aW9uL2Nvbm5lY3Rpb24uc2VydmljZS50c1wiIC8+XG5cbmltcG9ydCBRID0gcmVxdWlyZShcInFcIik7XG5pbXBvcnQgY29ubmVjdGlvbiA9IHJlcXVpcmUoJy4uL2Nvbm5lY3Rpb24vY29ubmVjdGlvbi5zZXJ2aWNlJylcbmltcG9ydCBQcm9kdWN0cyA9IHJlcXVpcmUoJy4uL3Byb2R1Y3RzL3Byb2R1Y3RzLnNlcnZpY2UnKVxuaW1wb3J0IEF1dGggPXJlcXVpcmUoJy4uL2F1dGgvYXV0aC5zZXJ2aWNlJylcbmltcG9ydCBhdmF0YXIgPSByZXF1aXJlKCcuLi9hdXRoL2F2YXRhci5zZXJ2aWNlJyk7XG5cbnZhciBwcm9kdWN0c1NlcnYgPSBuZXcgUHJvZHVjdHMuUHJvZHVjdHNTZXJ2aWNlKCk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1lbWJlcnNTZXJ2aWNlIHtcbiAgICAvLyBHRVRcbiAgICBnZXRNZW1iZXJzTGlzdCgpOiBRLklQcm9taXNlPHt9PjtcbiAgICBnZXRNZW1iZXJCeUlkKG1lbWJlcklkKTogUS5JUHJvbWlzZTx7fT47XG59XG5cblxuZXhwb3J0IGNsYXNzIE1lbWJlcnNTZXJ2aWNlIGltcGxlbWVudHMgSU1lbWJlcnNTZXJ2aWNlIHtcbiAgICBwcml2YXRlIGRiID0gY29ubmVjdGlvbi5zZXJ2aWNlO1xuXG4gICAgZ2V0TWVtYmVyc0xpc3QoKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX2xpc3RQcm9taXNlID0gUS5kZWZlcigpO1xuICAgICAgICB0aGlzLmRiLnF1ZXJ5X2RiKFwiU0VMRUNUIGlkLCBkaXNwbGF5X25hbWUgRlJPTSB3cDJfdXNlcnNcIilcbiAgICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgX2xpc3RQcm9taXNlLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIF9saXN0UHJvbWlzZS5wcm9taXNlO1xuICAgIH1cblxuICAgIGdldE1lbWJlckJ5SWQobWVtYmVySWQpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHZhciBfcHJvbWlzZSA9IFEuZGVmZXIoKTtcbiAgICAgICAgdmFyIGF2YXRhclNlcnZpY2UgPSBuZXcgYXZhdGFyLkF2YXRhclNlcnZpY2UoKTtcblxuICAgICAgICBwcm9kdWN0c1NlcnYuZ2V0UHJvZHVjdHNCeUF1dGhvcihtZW1iZXJJZCkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgICAgYXZhdGFyU2VydmljZS5nZXRVc2VyQXZhdGFyKG1lbWJlcklkLCBcInRodW1iXCIpXG4gICAgICAgICAgICAgICAgLnRoZW4oYXZhdGFySW5mbyA9PiB7XG4gICAgICAgICAgICAgICAgICAgICByZXN1bHRbJ2F1dGhvciddWydhdmF0YXInXSA9IGF2YXRhckluZm9bJ2F2YXRhciddO1xuICAgICAgICAgICAgICAgICAgICBfcHJvbWlzZS5yZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX3Byb21pc2UucHJvbWlzZTtcbiAgICB9XG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9