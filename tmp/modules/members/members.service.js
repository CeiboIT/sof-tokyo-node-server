/// <reference path="../../../typings/tsd.d.ts" />
/// <reference path="../connection/connection.service.ts" />
var Q = require("q");
var connection = require('../connection/connection.service');
var Products = require('../products/products.service');
var Auth = require('../auth/auth.service');
var authorsServ = new Auth.AuthService();
var productsServ = new Products.ProductsService();
var MembersService = (function () {
    function MembersService() {
        this.db = connection.service;
    }
    MembersService.prototype.getMembersList = function () {
        var _listPromise = Q.defer();
        this.db.query_db("SELECT id, display_name FROM wp2_users").then(function (data) {
            _listPromise.resolve(data);
        });
        return _listPromise.promise;
    };
    MembersService.prototype.getMemberById = function (memberId) {
        var _promise = Q.defer();
        productsServ.getProductsByAuthor(memberId).then(function (result) {
            authorsServ.getUserAvatar(memberId, "thumb").then(function (avatarInfo) {
                result['author']['avatar'] = avatarInfo['avatar'];
                _promise.resolve(result);
            });
        });
        return _promise.promise;
    };
    return MembersService;
})();
exports.MembersService = MembersService;
;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZXMvbWVtYmVycy9tZW1iZXJzLnNlcnZpY2UudHMiXSwibmFtZXMiOlsiTWVtYmVyc1NlcnZpY2UiLCJNZW1iZXJzU2VydmljZS5jb25zdHJ1Y3RvciIsIk1lbWJlcnNTZXJ2aWNlLmdldE1lbWJlcnNMaXN0IiwiTWVtYmVyc1NlcnZpY2UuZ2V0TWVtYmVyQnlJZCJdLCJtYXBwaW5ncyI6IkFBQUEsa0RBQWtEO0FBQ2xELDREQUE0RDtBQUU1RCxJQUFPLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQztBQUN4QixJQUFPLFVBQVUsV0FBVyxrQ0FBa0MsQ0FBQyxDQUFBO0FBQy9ELElBQU8sUUFBUSxXQUFXLDhCQUE4QixDQUFDLENBQUE7QUFDekQsSUFBTyxJQUFJLFdBQVUsc0JBQXNCLENBQUMsQ0FBQTtBQUU1QyxJQUFJLFdBQVcsR0FBRyxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUN6QyxJQUFJLFlBQVksR0FBRyxJQUFJLFFBQVEsQ0FBQyxlQUFlLEVBQUUsQ0FBQztBQVNsRCxJQUFhLGNBQWM7SUFBM0JBLFNBQWFBLGNBQWNBO1FBQ2ZDLE9BQUVBLEdBQUdBLFVBQVVBLENBQUNBLE9BQU9BLENBQUNBO0lBcUJwQ0EsQ0FBQ0E7SUFuQkdELHVDQUFjQSxHQUFkQTtRQUNJRSxJQUFJQSxZQUFZQSxHQUFHQSxDQUFDQSxDQUFDQSxLQUFLQSxFQUFFQSxDQUFDQTtRQUM3QkEsSUFBSUEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsUUFBUUEsQ0FBQ0Esd0NBQXdDQSxDQUFDQSxDQUNyREEsSUFBSUEsQ0FBQ0EsVUFBQ0EsSUFBSUE7WUFDUEEsWUFBWUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDL0JBLENBQUNBLENBQUNBLENBQUFBO1FBQ05BLE1BQU1BLENBQUNBLFlBQVlBLENBQUNBLE9BQU9BLENBQUNBO0lBQ2hDQSxDQUFDQTtJQUVERixzQ0FBYUEsR0FBYkEsVUFBY0EsUUFBUUE7UUFDbEJHLElBQUlBLFFBQVFBLEdBQUdBLENBQUNBLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBO1FBQ3pCQSxZQUFZQSxDQUFDQSxtQkFBbUJBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFVBQUFBLE1BQU1BO1lBQ2xEQSxXQUFXQSxDQUFDQSxhQUFhQSxDQUFDQSxRQUFRQSxFQUFFQSxPQUFPQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxVQUFBQSxVQUFVQTtnQkFDdkRBLE1BQU1BLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLFFBQVFBLENBQUNBLEdBQUdBLFVBQVVBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBO2dCQUNuREEsUUFBUUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7WUFDN0JBLENBQUNBLENBQUNBLENBQUFBO1FBQ05BLENBQUNBLENBQUNBLENBQUNBO1FBQ0hBLE1BQU1BLENBQUNBLFFBQVFBLENBQUNBLE9BQU9BLENBQUNBO0lBQzVCQSxDQUFDQTtJQUNMSCxxQkFBQ0E7QUFBREEsQ0F0QkEsQUFzQkNBLElBQUE7QUF0Qlksc0JBQWMsR0FBZCxjQXNCWixDQUFBO0FBQUEsQ0FBQyIsImZpbGUiOiJtb2R1bGVzL21lbWJlcnMvbWVtYmVycy5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uLy4uL3R5cGluZ3MvdHNkLmQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL2Nvbm5lY3Rpb24vY29ubmVjdGlvbi5zZXJ2aWNlLnRzXCIgLz5cblxuaW1wb3J0IFEgPSByZXF1aXJlKFwicVwiKTtcbmltcG9ydCBjb25uZWN0aW9uID0gcmVxdWlyZSgnLi4vY29ubmVjdGlvbi9jb25uZWN0aW9uLnNlcnZpY2UnKVxuaW1wb3J0IFByb2R1Y3RzID0gcmVxdWlyZSgnLi4vcHJvZHVjdHMvcHJvZHVjdHMuc2VydmljZScpXG5pbXBvcnQgQXV0aCA9cmVxdWlyZSgnLi4vYXV0aC9hdXRoLnNlcnZpY2UnKVxuXG52YXIgYXV0aG9yc1NlcnYgPSBuZXcgQXV0aC5BdXRoU2VydmljZSgpO1xudmFyIHByb2R1Y3RzU2VydiA9IG5ldyBQcm9kdWN0cy5Qcm9kdWN0c1NlcnZpY2UoKTtcblxuZXhwb3J0IGludGVyZmFjZSBJTWVtYmVyc1NlcnZpY2Uge1xuICAgIC8vIEdFVFxuICAgIGdldE1lbWJlcnNMaXN0KCk6IFEuSVByb21pc2U8e30+O1xuICAgIGdldE1lbWJlckJ5SWQobWVtYmVySWQpOiBRLklQcm9taXNlPHt9Pjtcbn1cblxuXG5leHBvcnQgY2xhc3MgTWVtYmVyc1NlcnZpY2UgaW1wbGVtZW50cyBJTWVtYmVyc1NlcnZpY2Uge1xuICAgIHByaXZhdGUgZGIgPSBjb25uZWN0aW9uLnNlcnZpY2U7XG5cbiAgICBnZXRNZW1iZXJzTGlzdCgpOiBRLklQcm9taXNlPHt9PiB7XG4gICAgICAgIHZhciBfbGlzdFByb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHRoaXMuZGIucXVlcnlfZGIoXCJTRUxFQ1QgaWQsIGRpc3BsYXlfbmFtZSBGUk9NIHdwMl91c2Vyc1wiKVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBfbGlzdFByb21pc2UucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIHJldHVybiBfbGlzdFByb21pc2UucHJvbWlzZTtcbiAgICB9XG5cbiAgICBnZXRNZW1iZXJCeUlkKG1lbWJlcklkKTogUS5JUHJvbWlzZTx7fT4ge1xuICAgICAgICB2YXIgX3Byb21pc2UgPSBRLmRlZmVyKCk7XG4gICAgICAgIHByb2R1Y3RzU2Vydi5nZXRQcm9kdWN0c0J5QXV0aG9yKG1lbWJlcklkKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICBhdXRob3JzU2Vydi5nZXRVc2VyQXZhdGFyKG1lbWJlcklkLCBcInRodW1iXCIpLnRoZW4oYXZhdGFySW5mbyA9PiB7XG4gICAgICAgICAgICAgICAgIHJlc3VsdFsnYXV0aG9yJ11bJ2F2YXRhciddID0gYXZhdGFySW5mb1snYXZhdGFyJ107XG4gICAgICAgICAgICAgICAgX3Byb21pc2UucmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfcHJvbWlzZS5wcm9taXNlO1xuICAgIH1cbn07XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=